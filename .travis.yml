language: java

sudo: true

notifications:
  email: false
  slack: fallanditurninn:XO6AI0eBjaYis0hTIzbunM44

deploy:
  provider: heroku
  api_key: acb27651-119b-486d-991a-7989c9b0cd23
  app: tranquil-castle-98562
  on:
    repo: FallandiTurninn/TicTacToe

before_install:
 - chmod +x gradlew
 - mkdir -p $HOME/.local/bin
 - travis_retry curl -L https://www.stackage.org/stack/linux-x86_64 | tar xz --wildcards --strip-components=1 -C ~/.local/bin '*/stack'

install:
 - stack setup
 - stack install pandoc

after_success:
 - ./convertToPdf.sh 
 - ./deployToPages.sh

env:
  global:
    secure: 47411ed10a18357559b874903f6b45511c1df0fd

before_install:
 - chmod +x gradlew

install:
 - ./gradlew assemble


before_script:
    - echo $TRAVIS_COMMIT
    - echo $TRAVIS_TAG
    - echo $TRAVIS_BRANCH
    - echo $TRAVIS_BUILD_NUMBER
    - echo $TRAVIS_REPO_SLUG

script:
 - ./gradlew check
 - ./gradlew jacocoTestReport
 - bash <(curl -s https://codecov.io/bash)

deploy:
  - provider: heroku
    api_key: 1983693b-f02d-4342-99e6-adcea68ceb7f
    app: ancient-gorge-29926
    on:
      repo: FallandiTurninn/TicTacToe
      all_branches: true

  - provider: heroku
    api_key: 1983693b-f02d-4342-99e6-adcea68ceb7f
    app: evening-hollows-74327
    on:
      repo: FallandiTurninn/TicTacToe
      branch: heroku_staging

  - provider: heroku
    api_key: acb27651-119b-486d-991a-7989c9b0cd23
    app: tranquil-castle-98562
    on:
      repo: FallandiTurninn/TicTacToe
      branch: master

